field = [257, 3329, 7681, 7937, 9473, 10753]

def ntt(a):
    print("pub unsafe fn ntt_"+str(a)+"(s0: [__m256i;16]) -> [__m256i;16]{")
    print("    let s1 = ntt1234_"+str(a)+"(s0);")
    print("    let s2 = transpose(s1);")
    print("    let s3 = ntt5678_"+str(a)+"(s2);")
    print("    s3\n}\n")


def ntt_l1(a):
    print("pub unsafe fn ntt1234_"+str(a)+"(a: [__m256i;16]) -> [__m256i;16]{")
    print("    let mut a0: [__m256i;16] = [_mm256_setzero_si256(); 16];")
    print("    let mut a1: [__m256i;16] = [_mm256_setzero_si256(); 16];")
    print("    // let l1 ~ l4")
    print("    // Layer 1")
    print("    for i in 0..8{")
    print("        [a0[i], a0[i+8]] = barrett_butterfly_"+str(a)+"(a[i], a[i+8], l1[0], l1[1]);")
    print("    }")
    print("    // Layer 2")
    print("    for i in 0..4{")
    print("        [a1[i], a1[i+4]] = barrett_butterfly_"+str(a)+"(a0[i], a0[i+4], l2[0], l2[1]);")
    print("        [a1[i+8], a1[i+12]] = barrett_butterfly_"+str(a)+"(a0[i+8], a0[i+12], l2[2], l2[3]);")
    print("    }")
    print("    // Layer 3")
    print("    for i in 0..4{")
    print("        for j in 0..2{")
    print("            [a0[i*4+j], a0[i*4+j+2]] = barrett_butterfly_"+str(a)+"(a1[i*4+j], a1[i*4+j+2], l3[2*i], l3[2*i+1]);")
    print("        }")
    print("    }")
    print("    // Layer 4")
    print("    for i in 0..8{")
    print("        [a1[i*2], a1[i*2+1]] = barrett_butterfly_"+str(a)+"(a0[i*2], a0[i*2+1], l4[2*i], l4[2*i+1]);")
    print("    }")
    print("    a1")
    print("}\n")

def ntt_l2(a):
    print("pub unsafe fn ntt5678_"+str(a)+"(a: [__m256i;16]) -> [__m256i;16]{")
    print("    let mut a0: [__m256i;16] = [_mm256_setzero_si256(); 16];")
    print("    let mut a1: [__m256i;16] = [_mm256_setzero_si256(); 16];")
    print("    // let l5 ~ l8")
    print("    // Layer 5")
    print("    for i in 0..8{")
    print("        [a0[i], a0[i+8]] = barrett_butterfly_"+str(a)+"(a[i], a[i+8], l5[0], l5[1]);")
    print("    }")
    print("    // Layer 6")
    print("    for i in 0..4{")
    print("        [a1[i], a1[i+4]] = barrett_butterfly_"+str(a)+"(a0[i], a0[i+4], l6[0], l6[1]);")
    print("        [a1[i+8], a1[i+12]] = barrett_butterfly_"+str(a)+"(a0[i+8], a0[i+12], l6[2], l6[3]);")
    print("    }")
    print("    // Layer 7")
    print("    for i in 0..4{")
    print("        for j in 0..2{")
    print("            [a0[i*4+j], a0[i*4+j+2]] = barrett_butterfly_"+str(a)+"(a1[i*4+j], a1[i*4+j+2], l7[2*i], l7[2*i+1]);")
    print("        }")
    print("    }")
    print("    // Layer 8")
    print("    for i in 0..8{")
    print("        [a1[i*2], a1[i*2+1]] = barrett_butterfly_"+str(a)+"(a0[i*2], a0[i*2+1], l8[2*i], l8[2*i+1]);")
    print("    }")
    print("    a1")
    print("}\n")

for f in field:
    ntt(f)
    ntt_l1(f)
    ntt_l2(f)